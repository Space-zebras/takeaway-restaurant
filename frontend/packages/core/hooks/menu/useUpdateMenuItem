import { useState } from "react";
import { MenuApi, type MenuItem, UpdateMenuItemBody } from "@app/core";

export function useUpdateMenuItem() {
    const [menuItem, setMenuItem] = useState<MenuItem | null>(null);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState<string | null>(null);

    async function updateMenuItem(id: string, body: UpdateMenuItemBody) {
        try {
            setLoading(true);
            setError(null);

            const res = await MenuApi.updateMenuItem(id, body);

            if(!res.menuItem) {
                throw new Error("No menu item returned from server");
            }

            setMenuItem(res.menuItem);
            return res.menuItem

        } catch (err: any) {
            setError(err.message ?? "Something went wrong" );
            throw err;
        } finally {
            setLoading(false)
        }
    }

    return { menuItem, loading, error, updateMenuItem };
}